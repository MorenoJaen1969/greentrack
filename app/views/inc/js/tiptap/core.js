/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@tiptap/core@3.0.0/dist/index.umd.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@tiptap/pm/state"),require("@tiptap/pm/view"),require("@tiptap/pm/keymap"),require("@tiptap/pm/model"),require("@tiptap/pm/transform"),require("@tiptap/pm/commands"),require("@tiptap/pm/schema-list")):"function"==typeof define&&define.amd?define(["exports","@tiptap/pm/state","@tiptap/pm/view","@tiptap/pm/keymap","@tiptap/pm/model","@tiptap/pm/transform","@tiptap/pm/commands","@tiptap/pm/schema-list"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@tiptap/core"]={},t.state,t.view,t.keymap,t.model,t.transform,t.commands$1,t.schemaList)}(this,(function(t,e,n,o,r,s,i,a){"use strict";function c(t){const{state:e,transaction:n}=t;let{selection:o}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return o},get doc(){return r},get tr(){return o=n.selection,r=n.doc,s=n.storedMarks,n}}}class d{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:o}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,(...t)=>{const n=e(...t)(s);return r.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(r),n}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i=[],a=!!t,c=t||r.tr,d={...Object.fromEntries(Object.entries(n).map((([t,n])=>[t,(...t)=>{const o=this.buildProps(c,e),r=n(...t)(o);return i.push(r),d}]))),run:()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(c),i.every((t=>!0===t)))};return d}createCan(t){const{rawCommands:e,state:n}=this,o=!1,r=t||n.tr,s=this.buildProps(r,o),i=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:void 0})])));return{...i,chain:()=>this.createChain(r,o)}}buildProps(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i={tr:t,editor:o,view:s,state:c({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map((([t,e])=>[t,(...t)=>e(...t)(i)])))}};return i}}class l{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function p(t,e,n){if(void 0===t.config[e]&&t.parent)return p(t.parent,e,n);if("function"==typeof t.config[e]){return t.config[e].bind({...n,parent:t.parent?p(t.parent,e,n):null})}return t.config[e]}function u(t){return{baseExtensions:t.filter((t=>"extension"===t.type)),nodeExtensions:t.filter((t=>"node"===t.type)),markExtensions:t.filter((t=>"mark"===t.type))}}function h(t){const e=[],{nodeExtensions:n,markExtensions:o}=u(t),r=[...n,...o],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach((t=>{const n=p(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage,extensions:r});if(!n)return;n().forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,o])=>{e.push({type:n,name:t,attribute:{...s,...o}})}))}))}))})),r.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},o=p(t,"addAttributes",n);if(!o)return;const r=o();Object.entries(r).forEach((([n,o])=>{const r={...s,...o};"function"==typeof(null==r?void 0:r.default)&&(r.default=r.default()),(null==r?void 0:r.isRequired)&&void 0===(null==r?void 0:r.default)&&delete r.default,e.push({type:t.name,name:n,attribute:r})}))})),e}function m(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function f(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{if(n[t])if("class"===t){const o=e?e.split(" "):[],r=n[t]?n[t].split(" "):[],s=o.filter((t=>!r.includes(t)));n[t]=[...r,...s].join(" ")}else n[t]="style"===t?[n[t],e].join("; "):e;else n[t]=e})),n}),{})}function g(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>f(t,e)),{})}function v(t){return"function"==typeof t}function y(t,e=void 0,...n){return v(t)?e?t.bind(e)(...n):t(...n):t}function b(t={}){return 0===Object.keys(t).length&&t.constructor===Object}function k(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}function x(t,e){return"style"in t?t:{...t,getAttrs:n=>{const o=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===o)return!1;const r=e.reduce(((t,e)=>{const o=e.attribute.parseHTML?e.attribute.parseHTML(n):k(n.getAttribute(e.name));return null==o?t:{...t,[e.name]:o}}),{});return{...o,...r}}}}function w(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!b(e))&&null!=e)))}function M(t,e){var n;const o=h(t),{nodeExtensions:s,markExtensions:i}=u(t),a=null===(n=s.find((t=>p(t,"topNode"))))||void 0===n?void 0:n.name,c=Object.fromEntries(s.map((n=>{const r=o.filter((t=>t.type===n.name)),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=w({...t.reduce(((t,e)=>{const o=p(e,"extendNodeSchema",s);return{...t,...o?o(n):{}}}),{}),content:y(p(n,"content",s)),marks:y(p(n,"marks",s)),group:y(p(n,"group",s)),inline:y(p(n,"inline",s)),atom:y(p(n,"atom",s)),selectable:y(p(n,"selectable",s)),draggable:y(p(n,"draggable",s)),code:y(p(n,"code",s)),whitespace:y(p(n,"whitespace",s)),defining:y(p(n,"defining",s)),isolating:y(p(n,"isolating",s)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=y(p(n,"parseHTML",s));a&&(i.parseDOM=a.map((t=>x(t,r))));const c=p(n,"renderHTML",s);c&&(i.toDOM=t=>c({node:t,HTMLAttributes:g(t,r)}));const d=p(n,"renderText",s);return d&&(i.toText=d),[n.name,i]}))),d=Object.fromEntries(i.map((n=>{const r=o.filter((t=>t.type===n.name)),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=w({...t.reduce(((t,e)=>{const o=p(e,"extendMarkSchema",s);return{...t,...o?o(n):{}}}),{}),inclusive:y(p(n,"inclusive",s)),excludes:y(p(n,"excludes",s)),group:y(p(n,"group",s)),spanning:y(p(n,"spanning",s)),code:y(p(n,"code",s)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),a=y(p(n,"parseHTML",s));a&&(i.parseDOM=a.map((t=>x(t,r))));const c=p(n,"renderHTML",s);return c&&(i.toDOM=t=>c({mark:t,HTMLAttributes:g(t,r)})),[n.name,i]})));return new r.Schema({topNode:a,nodes:c,marks:d})}function S(t,e){return e.nodes[t]||e.marks[t]||null}function E(t,e){return Array.isArray(e)?e.some((e=>("string"==typeof e?e:e.name)===t.name)):e}const O=(t,e=500)=>{let n="";const o=t.parentOffset;return t.parent.nodesBetween(Math.max(0,o-e),o,((t,e,r,s)=>{var i,a;const c=(null===(a=(i=t.type.spec).toText)||void 0===a?void 0:a.call(i,{node:t,pos:e,parent:r,index:s}))||t.textContent||"%leaf%";n+=c.slice(0,Math.max(0,o-e))})),n};function T(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class C{constructor(t){this.find=t.find,this.handler=t.handler}}function P(t){var e;const{editor:n,from:o,to:r,text:s,rules:i,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const p=l.state.doc.resolve(o);if(p.parent.type.spec.code||(null===(e=p.nodeBefore||p.nodeAfter)||void 0===e?void 0:e.marks.find((t=>t.type.spec.code))))return!1;let u=!1;const h=O(p)+s;return i.forEach((t=>{if(u)return;const e=((t,e)=>{if(T(e))return e.exec(t);const n=e(t);if(!n)return null;const o=[n.text];return o.index=n.index,o.input=t,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o})(h,t.find);if(!e)return;const i=l.state.tr,p=c({state:l.state,transaction:i}),m={from:o-(e[0].length-s.length),to:r},{commands:f,chain:g,can:v}=new d({editor:n,state:p});null!==t.handler({state:p,range:m,match:e,commands:f,chain:g,can:v})&&i.steps.length&&(i.setMeta(a,{transform:i,from:o,to:r,text:s}),l.dispatch(i),u=!0)})),u}function A(t){const{editor:n,rules:o}=t,r=new e.Plugin({state:{init:()=>null,apply(t,e){const s=t.getMeta(r);if(s)return s;const i=t.getMeta("applyInputRules");return!!i&&setTimeout((()=>{const{from:t,text:e}=i,s=t+e.length;P({editor:n,from:t,to:s,text:e,rules:o,plugin:r})})),t.selectionSet||t.docChanged?null:e}},props:{handleTextInput:(t,e,s,i)=>P({editor:n,from:e,to:s,text:i,rules:o,plugin:r}),handleDOMEvents:{compositionend:t=>(setTimeout((()=>{const{$cursor:e}=t.state.selection;e&&P({editor:n,from:e.pos,to:e.pos,text:"",rules:o,plugin:r})})),!1)},handleKeyDown(t,e){if("Enter"!==e.key)return!1;const{$cursor:s}=t.state.selection;return!!s&&P({editor:n,from:s.pos,to:s.pos,text:"\n",rules:o,plugin:r})}},isInputRules:!0});return r}function N(t){return"number"==typeof t}class ${constructor(t){this.find=t.find,this.handler=t.handler}}function j(t){const{editor:e,state:n,from:o,to:r,rule:s,pasteEvent:i,dropEvent:a}=t,{commands:c,chain:l,can:p}=new d({editor:e,state:n}),u=[];n.doc.nodesBetween(o,r,((t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const d=Math.max(o,e),h=Math.min(r,e+t.content.size);((t,e,n)=>{if(T(e))return[...t.matchAll(e)];const o=e(t,n);return o?o.map((e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n})):[]})(t.textBetween(d-e,h-e,void 0,"￼"),s.find,i).forEach((t=>{if(void 0===t.index)return;const e=d+t.index+1,o=e+t[0].length,r={from:n.tr.mapping.map(e),to:n.tr.mapping.map(o)},h=s.handler({state:n,range:r,match:t,commands:c,chain:l,can:p,pasteEvent:i,dropEvent:a});u.push(h)}))}));return u.every((t=>null!==t))}function I(t){const{editor:n,rules:o}=t;let r=null,s=!1,i=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,d="undefined"!=typeof DragEvent?new DragEvent("drop"):null;const l=({state:t,from:e,to:o,rule:r,pasteEvt:s})=>{const i=t.tr,l=c({state:t,transaction:i});if(j({editor:n,state:l,from:Math.max(e-1,0),to:o.b-1,rule:r,pasteEvent:s,dropEvent:d})&&i.steps.length)return d="undefined"!=typeof DragEvent?new DragEvent("drop"):null,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,i},p=o.map((t=>new e.Plugin({view(t){const e=e=>{var n;r=(null===(n=t.dom.parentElement)||void 0===n?void 0:n.contains(e.target))?t.dom.parentElement:null};return window.addEventListener("dragstart",e),{destroy(){window.removeEventListener("dragstart",e)}}},props:{handleDOMEvents:{drop:(t,e)=>(i=r===t.dom.parentElement,d=e,!1),paste:(t,e)=>{var n;const o=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=e,s=!!(null==o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(e,n,o)=>{const r=e[0],c="paste"===r.getMeta("uiEvent")&&!s,d="drop"===r.getMeta("uiEvent")&&!i,p=r.getMeta("applyPasteRules"),u=!!p;if(!c&&!d&&!u)return;if(u){const{from:e,text:n}=p,r=e+n.length,s=(t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(e=n.clipboardData)||void 0===e||e.setData("text/html",t),n})(n);return l({rule:t,state:o,from:e,to:{b:r},pasteEvt:s})}const h=n.doc.content.findDiffStart(o.doc.content),m=n.doc.content.findDiffEnd(o.doc.content);return N(h)&&m&&h!==m.b?l({rule:t,state:o,from:h,to:m,pasteEvt:a}):void 0}})));return p}function R(t){const e=t.filter(((e,n)=>t.indexOf(e)!==n));return[...new Set(e)]}class B{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=B.resolve(t),this.schema=M(this.extensions,e),this.setupExtensions()}static resolve(t){const e=B.sort(B.flatten(t)),n=R(e.map((t=>t.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((t=>`'${t}'`)).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map((t=>{const e=p(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...this.flatten(e())]:t})).flat(10)}static sort(t){return t.sort(((t,e)=>{const n=p(t,"priority")||100,o=p(e,"priority")||100;return n>o?-1:n<o?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n=p(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:S(e.name,this.schema)});return n?{...t,...n()}:t}),{})}get plugins(){const{editor:t}=this,e=B.sort([...this.extensions].reverse()),n=[],r=[],s=e.map((e=>{const s={name:e.name,options:e.options,storage:e.storage,editor:t,type:S(e.name,this.schema)},i=[],a=p(e,"addKeyboardShortcuts",s);let c={};if("mark"===e.type&&p(e,"exitable",s)&&(c.ArrowRight=()=>Rt.handleExit({editor:t,mark:e})),a){const e=Object.fromEntries(Object.entries(a()).map((([e,n])=>[e,()=>n({editor:t})])));c={...c,...e}}const d=o.keymap(c);i.push(d);const l=p(e,"addInputRules",s);E(e,t.options.enableInputRules)&&l&&n.push(...l());const u=p(e,"addPasteRules",s);E(e,t.options.enablePasteRules)&&u&&r.push(...u());const h=p(e,"addProseMirrorPlugins",s);if(h){const t=h();i.push(...t)}return i})).flat();return[A({editor:t,rules:n}),...I({editor:t,rules:r}),...s]}get attributes(){return h(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=u(this.extensions);return Object.fromEntries(e.filter((t=>!!p(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),o={name:e.name,options:e.options,storage:e.storage,editor:t,type:m(e.name,this.schema)},r=p(e,"addNodeView",o);if(!r)return[];return[e.name,(o,s,i,a)=>{const c=g(o,n);return r()({editor:t,node:o,getPos:i,decorations:a,HTMLAttributes:c,extension:e})}]})))}setupExtensions(){this.extensions.forEach((t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:S(t.name,this.schema)};if("mark"===t.type){(null===(e=y(p(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name)}const o=p(t,"onBeforeCreate",n),r=p(t,"onCreate",n),s=p(t,"onUpdate",n),i=p(t,"onSelectionUpdate",n),a=p(t,"onTransaction",n),c=p(t,"onFocus",n),d=p(t,"onBlur",n),l=p(t,"onDestroy",n);o&&this.editor.on("beforeCreate",o),r&&this.editor.on("create",r),s&&this.editor.on("update",s),i&&this.editor.on("selectionUpdate",i),a&&this.editor.on("transaction",a),c&&this.editor.on("focus",c),d&&this.editor.on("blur",d),l&&this.editor.on("destroy",l)}))}}function D(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function z(t,e){const n={...t};return D(t)&&D(e)&&Object.keys(e).forEach((o=>{D(e[o])&&D(t[o])?n[o]=z(t[o],e[o]):n[o]=e[o]})),n}class L{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=y(p(this,"addOptions",{name:this.name}))),this.storage=y(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new L(t)}configure(t={}){const e=this.extend({...this.config,addOptions(){var e;return z((null===(e=this.parent)||void 0===e?void 0:e.call(this))||{},t)}});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new L({...this.config,...t});return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=y(p(e,"addOptions",{name:e.name})),e.storage=y(p(e,"addStorage",{name:e.name,options:e.options})),e}}function F(t,e,n){const{from:o,to:r}=e,{blockSeparator:s="\n\n",textSerializers:i={}}=n||{};let a="";return t.nodesBetween(o,r,((t,n,c,d)=>{var l;t.isBlock&&n>o&&(a+=s);const p=null==i?void 0:i[t.type.name];if(p)return c&&(a+=p({node:t,pos:n,parent:c,index:d,range:e})),!1;t.isText&&(a+=null===(l=null==t?void 0:t.text)||void 0===l?void 0:l.slice(Math.max(o,n)-n,r-n))})),a}function H(t){return Object.fromEntries(Object.entries(t.nodes).filter((([,t])=>t.spec.toText)).map((([t,e])=>[t,e.spec.toText])))}const V=L.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:o,selection:r}=e,{ranges:s}=r,i=Math.min(...s.map((t=>t.$from.pos))),a=Math.max(...s.map((t=>t.$to.pos))),c=H(n);return F(o,{from:i,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}});function q(t,e,n={strict:!0}){const o=Object.keys(e);return!o.length||o.every((o=>n.strict?e[o]===t[o]:T(e[o])?e[o].test(t[o]):e[o]===t[o]))}function K(t,e,n={}){return t.find((t=>t.type===e&&q(t.attrs,n)))}function W(t,e,n={}){return!!K(t,e,n)}function _(t,e,n={}){if(!t||!e)return;let o=t.parent.childAfter(t.parentOffset);if(t.parentOffset===o.offset&&0!==o.offset&&(o=t.parent.childBefore(t.parentOffset)),!o.node)return;const r=K([...o.node.marks],e,n);if(!r)return;let s=o.index,i=t.start()+o.offset,a=s+1,c=i+o.node.nodeSize;for(K([...o.node.marks],e,n);s>0&&r.isInSet(t.parent.child(s-1).marks);)s-=1,i-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&W([...t.parent.child(a).marks],e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:i,to:c}}function J(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function U(t){return t instanceof e.TextSelection}function G(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function X(t,n=null){if(!n)return null;const o=e.Selection.atStart(t),r=e.Selection.atEnd(t);if("start"===n||!0===n)return o;if("end"===n)return r;const s=o.from,i=r.to;return"all"===n?e.TextSelection.create(t,G(0,s,i),G(t.content.size,s,i)):e.TextSelection.create(t,G(n,s,i),G(n,s,i))}function Y(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Q=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const o=e[n];3===o.nodeType&&o.nodeValue&&/^(\n\s\s|\n)$/.test(o.nodeValue)?t.removeChild(o):1===o.nodeType&&Q(o)}return t};function Z(t){const e=`<body>${t}</body>`,n=(new window.DOMParser).parseFromString(e,"text/html").body;return Q(n)}function tt(t,e,n){n={slice:!0,parseOptions:{},...n};const o="string"==typeof t;if("object"==typeof t&&null!==t)try{return Array.isArray(t)&&t.length>0?r.Fragment.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),tt("",e,n)}if(o){let o=e,s=!1,i="";n.errorOnInvalidContent&&(o=new r.Schema({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:t=>(s=!0,i="string"==typeof t?t:t.outerHTML,null)}]}})}));const a=r.DOMParser.fromSchema(o),c=n.slice?a.parseSlice(Z(t),n.parseOptions).content:a.parse(Z(t),n.parseOptions);if(n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${i}`)});return c}return tt("",e,n)}function et(t,n,o){const r=t.steps.length-1;if(r<n)return;const i=t.steps[r];if(!(i instanceof s.ReplaceStep||i instanceof s.ReplaceAroundStep))return;const a=t.mapping.maps[r];let c=0;a.forEach(((t,e,n,o)=>{0===c&&(c=o)})),t.setSelection(e.Selection.near(t.doc.resolve(c),o))}function nt(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function ot(t,e,n={}){const{from:o,to:r,empty:s}=t.selection,i=e?m(e,t.schema):null,a=[];t.doc.nodesBetween(o,r,((t,e)=>{if(t.isText)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);a.push({node:t,from:n,to:s})}));const c=r-o,d=a.filter((t=>!i||i.name===t.node.type.name)).filter((t=>q(t.node.attrs,n,{strict:!1})));if(s)return!!d.length;return d.reduce(((t,e)=>t+e.to-e.from),0)>=c}function rt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function st(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce(((e,o)=>(n.includes(o)||(e[o]=t[o]),e)),{})}function it(t,e,n={},o={}){return tt(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:o.errorOnInvalidContent})}function at(t,e){const n=J(e,t.schema),{from:o,to:r,empty:s}=t.selection,i=[];s?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(o,r,(t=>{i.push(...t.marks)}));const a=i.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}function ct(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function dt(t,e){for(let n=t.depth;n>0;n-=1){const o=t.node(n);if(e(o))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:o}}}function lt(t){return e=>dt(e.$from,t)}function pt(t,e){const n=r.DOMSerializer.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function ut(t,e){return M(B.resolve(t),e)}function ht(t,e){return F(t,{from:0,to:t.content.size},e)}function mt(t,e){const n=m(e,t.schema),{from:o,to:r}=t.selection,s=[];t.doc.nodesBetween(o,r,(t=>{s.push(t)}));const i=s.reverse().find((t=>t.type.name===n.name));return i?{...i.attrs}:{}}function ft(t,e){const n=rt("string"==typeof e?e:e.name,t.schema);return"node"===n?mt(t,e):"mark"===n?at(t,e):{}}function gt(t,e=JSON.stringify){const n={};return t.filter((t=>{const o=e(t);return!Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=!0)}))}function vt(t,e,n){const o=[];return t===e?n.resolve(t).marks().forEach((e=>{const r=_(n.resolve(t-1),e.type);r&&o.push({mark:e,...r})})):n.nodesBetween(t,e,((t,e)=>{t&&void 0!==(null==t?void 0:t.nodeSize)&&o.push(...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n}))))})),o}function yt(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const o=t.find((t=>t.type===e&&t.name===n));return!!o&&o.attribute.keepOnSplit})))}function bt(t,e,n={}){const{empty:o,ranges:r}=t.selection,s=e?J(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!s||s.name===t.type.name)).find((t=>q(t.attrs,n,{strict:!1})));let i=0;const a=[];if(r.forEach((({$from:e,$to:n})=>{const o=e.pos,r=n.pos;t.doc.nodesBetween(o,r,((t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);i+=s-n,a.push(...t.marks.map((t=>({mark:t,from:n,to:s}))))}))})),0===i)return!1;const c=a.filter((t=>!s||s.name===t.mark.type.name)).filter((t=>q(t.mark.attrs,n,{strict:!1}))).reduce(((t,e)=>t+e.to-e.from),0),d=a.filter((t=>!s||t.mark.type!==s&&t.mark.type.excludes(s))).reduce(((t,e)=>t+e.to-e.from),0);return(c>0?c+d:c)>=i}function kt(t,e,n={}){if(!e)return ot(t,null,n)||bt(t,null,n);const o=rt(e,t.schema);return"node"===o?ot(t,e,n):"mark"===o&&bt(t,e,n)}function xt(t,e){const{nodeExtensions:n}=u(e),o=n.find((e=>e.name===t));if(!o)return!1;const r=y(p(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function wt(t){const e=t.type.createAndFill();return!!e&&t.eq(e)}function Mt(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const o=n.filter((t=>null==e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(o)}}const St=(t,e)=>{const n=lt((t=>t.type===e))(t.selection);if(!n)return!0;const o=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===o)return!0;const r=t.doc.nodeAt(o);return n.node.type!==(null==r?void 0:r.type)||!s.canJoin(t.doc,n.pos)||(t.join(n.pos),!0)},Et=(t,e)=>{const n=lt((t=>t.type===e))(t.selection);if(!n)return!0;const o=t.doc.resolve(n.start).after(n.depth);if(void 0===o)return!0;const r=t.doc.nodeAt(o);return n.node.type!==(null==r?void 0:r.type)||!s.canJoin(t.doc,o)||(t.join(o),!0)};var Ot=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame((()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0),clearContent:(t=!1)=>({commands:e})=>e.setContent("",t),clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:o}=e,{ranges:r}=o;return!n||(r.forEach((({$from:n,$to:o})=>{t.doc.nodesBetween(n.pos,o.pos,((t,n)=>{if(t.type.isText)return;const{doc:o,mapping:r}=e,i=o.resolve(r.map(n)),a=o.resolve(r.map(n+t.nodeSize)),c=i.blockRange(a);if(!c)return;const d=s.liftTarget(c);if(t.type.isTextblock){const{defaultType:t}=i.parent.contentMatchAt(i.index());e.setNodeMarkup(c.start,t)}(d||0===d)&&e.lift(c,d)}))})),!0)},command:t=>e=>t(e),createParagraphNear:()=>({state:t,dispatch:e})=>i.createParagraphNear(t,e),cut:(t,n)=>({editor:o,tr:r})=>{const{state:s}=o,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const a=r.mapping.map(n);return r.insert(a,i.content),r.setSelection(new e.TextSelection(r.doc.resolve(a-1))),!0},deleteCurrentNode:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,o=n.$anchor.node();if(o.content.size>0)return!1;const r=t.selection.$anchor;for(let n=r.depth;n>0;n-=1){if(r.node(n).type===o.type){if(e){const e=r.before(n),o=r.after(n);t.delete(e,o).scrollIntoView()}return!0}}return!1},deleteNode:t=>({tr:e,state:n,dispatch:o})=>{const r=m(t,n.schema),s=e.selection.$anchor;for(let t=s.depth;t>0;t-=1){if(s.node(t).type===r){if(o){const n=s.before(t),o=s.after(t);e.delete(n,o).scrollIntoView()}return!0}}return!1},deleteRange:t=>({tr:e,dispatch:n})=>{const{from:o,to:r}=t;return n&&e.delete(o,r),!0},deleteSelection:()=>({state:t,dispatch:e})=>i.deleteSelection(t,e),enter:()=>({commands:t})=>t.keyboardShortcut("Enter"),exitCode:()=>({state:t,dispatch:e})=>i.exitCode(t,e),extendMarkRange:(t,n={})=>({tr:o,state:r,dispatch:s})=>{const i=J(t,r.schema),{doc:a,selection:c}=o,{$from:d,from:l,to:p}=c;if(s){const t=_(d,i,n);if(t&&t.from<=l&&t.to>=p){const n=e.TextSelection.create(a,t.from,t.to);o.setSelection(n)}}return!0},first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1},focus:(t=null,e={})=>({editor:n,view:o,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const i=()=>{Y()&&o.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(o.focus(),(null==e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())}))};if(o.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!U(n.state.selection))return i(),!0;const a=X(r.doc,t)||n.state.selection,c=n.state.selection.eq(a);return s&&(c||r.setSelection(a),c&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},forEach:(t,e)=>n=>t.every(((t,o)=>e(t,{...n,index:o}))),insertContent:(t,e)=>({tr:n,commands:o})=>o.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),insertContentAt:(t,e,n)=>({tr:o,dispatch:r,editor:s})=>{var i;if(r){let r;n={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};try{r=tt(e,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:null!==(i=n.errorOnInvalidContent)&&void 0!==i?i:s.options.enableContentCheck})}catch(t){return!1}let{from:a,to:c}="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},d=!0,l=!0;if(("type"in r?[r]:r).forEach((t=>{t.check(),d=!!d&&(t.isText&&0===t.marks.length),l=!!l&&t.isBlock})),a===c&&l){const{parent:t}=o.doc.resolve(a);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(a-=1,c+=1)}let p;d?(p=Array.isArray(e)?e.map((t=>t.text||"")).join(""):"object"==typeof e&&e&&e.text?e.text:e,o.insertText(p,a,c)):(p=r,o.replaceWith(a,c,p)),n.updateSelection&&et(o,o.steps.length-1,-1),n.applyInputRules&&o.setMeta("applyInputRules",{from:a,text:p}),n.applyPasteRules&&o.setMeta("applyPasteRules",{from:a,text:p})}return!0},joinBackward:()=>({state:t,dispatch:e})=>i.joinBackward(t,e),joinDown:()=>({state:t,dispatch:e})=>i.joinDown(t,e),joinForward:()=>({state:t,dispatch:e})=>i.joinForward(t,e),joinItemBackward:()=>({state:t,dispatch:e,tr:n})=>{try{const o=s.joinPoint(t.doc,t.selection.$from.pos,-1);return null!=o&&(n.join(o,2),e&&e(n),!0)}catch(t){return!1}},joinItemForward:()=>({state:t,dispatch:e,tr:n})=>{try{const o=s.joinPoint(t.doc,t.selection.$from.pos,1);return null!=o&&(n.join(o,2),e&&e(n),!0)}catch(t){return!1}},joinTextblockBackward:()=>({state:t,dispatch:e})=>i.joinTextblockBackward(t,e),joinTextblockForward:()=>({state:t,dispatch:e})=>i.joinTextblockForward(t,e),joinUp:()=>({state:t,dispatch:e})=>i.joinUp(t,e),keyboardShortcut:t=>({editor:e,view:n,tr:o,dispatch:r})=>{const s=function(t){const e=t.split(/-(?!$)/);let n,o,r,s,i=e[e.length-1];"Space"===i&&(i=" ");for(let t=0;t<e.length-1;t+=1){const i=e[t];if(/^(cmd|meta|m)$/i.test(i))s=!0;else if(/^a(lt)?$/i.test(i))n=!0;else if(/^(c|ctrl|control)$/i.test(i))o=!0;else if(/^s(hift)?$/i.test(i))r=!0;else{if(!/^mod$/i.test(i))throw new Error(`Unrecognized modifier name: ${i}`);Y()||nt()?s=!0:o=!0}}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),r&&(i=`Shift-${i}`),i}(t).split(/-(?!$)/),i=s.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===i?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null==c||c.steps.forEach((t=>{const e=t.map(o.mapping);e&&r&&o.maybeStep(e)})),!0},lift:(t,e={})=>({state:n,dispatch:o})=>!!ot(n,m(t,n.schema),e)&&i.lift(n,o),liftEmptyBlock:()=>({state:t,dispatch:e})=>i.liftEmptyBlock(t,e),liftListItem:t=>({state:e,dispatch:n})=>{const o=m(t,e.schema);return a.liftListItem(o)(e,n)},newlineInCode:()=>({state:t,dispatch:e})=>i.newlineInCode(t,e),resetAttributes:(t,e)=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=rt("string"==typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=m(t,o.schema)),"mark"===a&&(i=J(t,o.schema)),r&&n.selection.ranges.forEach((t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,o)=>{s&&s===t.type&&n.setNodeMarkup(o,void 0,st(t.attrs,e)),i&&t.marks.length&&t.marks.forEach((r=>{i===r.type&&n.addMark(o,o+t.nodeSize,i.create(st(r.attrs,e)))}))}))})),!0)},scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),selectAll:()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),selectNodeBackward:()=>({state:t,dispatch:e})=>i.selectNodeBackward(t,e),selectNodeForward:()=>({state:t,dispatch:e})=>i.selectNodeForward(t,e),selectParentNode:()=>({state:t,dispatch:e})=>i.selectParentNode(t,e),selectTextblockEnd:()=>({state:t,dispatch:e})=>i.selectTextblockEnd(t,e),selectTextblockStart:()=>({state:t,dispatch:e})=>i.selectTextblockStart(t,e),setContent:(t,e=!1,n={},o={})=>({editor:r,tr:s,dispatch:i,commands:a})=>{var c,d;const{doc:l}=s;if("full"!==n.preserveWhitespace){const a=it(t,r.schema,n,{errorOnInvalidContent:null!==(c=o.errorOnInvalidContent)&&void 0!==c?c:r.options.enableContentCheck});return i&&s.replaceWith(0,l.content.size,a).setMeta("preventUpdate",!e),!0}return i&&s.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:null!==(d=o.errorOnInvalidContent)&&void 0!==d?d:r.options.enableContentCheck})},setMark:(t,e={})=>({tr:n,state:o,dispatch:r})=>{const{selection:s}=n,{empty:i,ranges:a}=s,c=J(t,o.schema);if(r)if(i){const t=at(o,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach((t=>{const r=t.$from.pos,s=t.$to.pos;o.doc.nodesBetween(r,s,((t,o)=>{const i=Math.max(o,r),a=Math.min(o+t.nodeSize,s);t.marks.find((t=>t.type===c))?t.marks.forEach((t=>{c===t.type&&n.addMark(i,a,c.create({...t.attrs,...e}))})):n.addMark(i,a,c.create(e))}))}));return function(t,e,n){var o;const{selection:r}=e;let s=null;if(U(r)&&(s=r.$cursor),s){const e=null!==(o=t.storedMarks)&&void 0!==o?o:s.marks();return!!n.isInSet(e)||!e.some((t=>t.type.excludes(n)))}const{ranges:i}=r;return i.some((({$from:e,$to:o})=>{let r=0===e.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(e.pos,o.pos,((t,e,o)=>{if(r)return!1;if(t.isInline){const e=!o||o.type.allowsMarkType(n),s=!!n.isInSet(t.marks)||!t.marks.some((t=>t.type.excludes(n)));r=e&&s}return!r})),r}))}(o,n,c)},setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),setNode:(t,e={})=>({state:n,dispatch:o,chain:r})=>{const s=m(t,n.schema);return s.isTextblock?r().command((({commands:t})=>!!i.setBlockType(s,e)(n)||t.clearNodes())).command((({state:t})=>i.setBlockType(s,e)(t,o))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:t=>({tr:n,dispatch:o})=>{if(o){const{doc:o}=n,r=G(t,0,o.content.size),s=e.NodeSelection.create(o,r);n.setSelection(s)}return!0},setTextSelection:t=>({tr:n,dispatch:o})=>{if(o){const{doc:o}=n,{from:r,to:s}="number"==typeof t?{from:t,to:t}:t,i=e.TextSelection.atStart(o).from,a=e.TextSelection.atEnd(o).to,c=G(r,i,a),d=G(s,i,a),l=e.TextSelection.create(o,c,d);n.setSelection(l)}return!0},sinkListItem:t=>({state:e,dispatch:n})=>{const o=m(t,e.schema);return a.sinkListItem(o)(e,n)},splitBlock:({keepMarks:t=!0}={})=>({tr:n,state:o,dispatch:r,editor:i})=>{const{selection:a,doc:c}=n,{$from:d,$to:l}=a,p=yt(i.extensionManager.attributes,d.node().type.name,d.node().attrs);if(a instanceof e.NodeSelection&&a.node.isBlock)return!(!d.parentOffset||!s.canSplit(c,d.pos))&&(r&&(t&&Mt(o,i.extensionManager.splittableMarks),n.split(d.pos).scrollIntoView()),!0);if(!d.parent.isBlock)return!1;if(r){const r=l.parentOffset===l.parent.content.size;a instanceof e.TextSelection&&n.deleteSelection();const c=0===d.depth?void 0:ct(d.node(-1).contentMatchAt(d.indexAfter(-1)));let u=r&&c?[{type:c,attrs:p}]:void 0,h=s.canSplit(n.doc,n.mapping.map(d.pos),1,u);if(u||h||!s.canSplit(n.doc,n.mapping.map(d.pos),1,c?[{type:c}]:void 0)||(h=!0,u=c?[{type:c,attrs:p}]:void 0),h&&(n.split(n.mapping.map(d.pos),1,u),c&&!r&&!d.parentOffset&&d.parent.type!==c)){const t=n.mapping.map(d.before()),e=n.doc.resolve(t);d.node(-1).canReplaceWith(e.index(),e.index()+1,c)&&n.setNodeMarkup(n.mapping.map(d.before()),c)}t&&Mt(o,i.extensionManager.splittableMarks),n.scrollIntoView()}return!0},splitListItem:t=>({tr:n,state:o,dispatch:i,editor:a})=>{var c;const d=m(t,o.schema),{$from:l,$to:p}=o.selection,u=o.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(p))return!1;const h=l.node(-1);if(h.type!==d)return!1;const f=a.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==d||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let t=r.Fragment.empty;const o=l.index(-1)?1:l.index(-2)?2:3;for(let e=l.depth-o;e>=l.depth-3;e-=1)t=r.Fragment.from(l.node(e).copy(t));const s=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,i=yt(f,l.node().type.name,l.node().attrs),a=(null===(c=d.contentMatch.defaultType)||void 0===c?void 0:c.createAndFill(i))||void 0;t=t.append(r.Fragment.from(d.createAndFill(null,a)||void 0));const p=l.before(l.depth-(o-1));n.replace(p,l.after(-s),new r.Slice(t,4-o,0));let u=-1;n.doc.nodesBetween(p,n.doc.content.size,((t,e)=>{if(u>-1)return!1;t.isTextblock&&0===t.content.size&&(u=e+1)})),u>-1&&n.setSelection(e.TextSelection.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}const g=p.pos===l.end()?h.contentMatchAt(0).defaultType:null,v=yt(f,h.type.name,h.attrs),y=yt(f,l.node().type.name,l.node().attrs);n.delete(l.pos,p.pos);const b=g?[{type:d,attrs:v},{type:g,attrs:y}]:[{type:d,attrs:v}];if(!s.canSplit(n.doc,l.pos,2))return!1;if(i){const{selection:t,storedMarks:e}=o,{splittableMarks:r}=a.extensionManager,s=e||t.$to.parentOffset&&t.$from.marks();if(n.split(l.pos,2,b).scrollIntoView(),!s||!i)return!0;const c=s.filter((t=>r.includes(t.type.name)));n.ensureMarks(c)}return!0},toggleList:(t,e,n,o={})=>({editor:r,tr:s,state:i,dispatch:a,chain:c,commands:d,can:l})=>{const{extensions:p,splittableMarks:u}=r.extensionManager,h=m(t,i.schema),f=m(e,i.schema),{selection:g,storedMarks:v}=i,{$from:y,$to:b}=g,k=y.blockRange(b),x=v||g.$to.parentOffset&&g.$from.marks();if(!k)return!1;const w=lt((t=>xt(t.type.name,p)))(g);if(k.depth>=1&&w&&k.depth-w.depth<=1){if(w.node.type===h)return d.liftListItem(f);if(xt(w.node.type.name,p)&&h.validContent(w.node.content)&&a)return c().command((()=>(s.setNodeMarkup(w.pos,h),!0))).command((()=>St(s,h))).command((()=>Et(s,h))).run()}return n&&x&&a?c().command((()=>{const t=l().wrapInList(h,o),e=x.filter((t=>u.includes(t.type.name)));return s.ensureMarks(e),!!t||d.clearNodes()})).wrapInList(h,o).command((()=>St(s,h))).command((()=>Et(s,h))).run():c().command((()=>!!l().wrapInList(h,o)||d.clearNodes())).wrapInList(h,o).command((()=>St(s,h))).command((()=>Et(s,h))).run()},toggleMark:(t,e={},n={})=>({state:o,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,i=J(t,o.schema);return bt(o,i,e)?r.unsetMark(i,{extendEmptyMarkRange:s}):r.setMark(i,e)},toggleNode:(t,e,n={})=>({state:o,commands:r})=>{const s=m(t,o.schema),i=m(e,o.schema);return ot(o,s,n)?r.setNode(i):r.setNode(s,n)},toggleWrap:(t,e={})=>({state:n,commands:o})=>{const r=m(t,n.schema);return ot(n,r,e)?o.lift(r):o.wrapIn(r,e)},undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let o=0;o<n.length;o+=1){const r=n[o];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:o,ranges:r}=n;return o||e&&r.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0},unsetMark:(t,e={})=>({tr:n,state:o,dispatch:r})=>{var s;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=J(t,o.schema),{$from:d,empty:l,ranges:p}=a;if(!r)return!0;if(l&&i){let{from:t,to:e}=a;const o=null===(s=d.marks().find((t=>t.type===c)))||void 0===s?void 0:s.attrs,r=_(d,c,o);r&&(t=r.from,e=r.to),n.removeMark(t,e,c)}else p.forEach((t=>{n.removeMark(t.$from.pos,t.$to.pos,c)}));return n.removeStoredMark(c),!0},updateAttributes:(t,e={})=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=rt("string"==typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=m(t,o.schema)),"mark"===a&&(i=J(t,o.schema)),r&&n.selection.ranges.forEach((t=>{const r=t.$from.pos,a=t.$to.pos;o.doc.nodesBetween(r,a,((t,o)=>{s&&s===t.type&&n.setNodeMarkup(o,void 0,{...t.attrs,...e}),i&&t.marks.length&&t.marks.forEach((s=>{if(i===s.type){const c=Math.max(o,r),d=Math.min(o+t.nodeSize,a);n.addMark(c,d,i.create({...s.attrs,...e}))}}))}))})),!0)},wrapIn:(t,e={})=>({state:n,dispatch:o})=>{const r=m(t,n.schema);return i.wrapIn(r,e)(n,o)},wrapInList:(t,e={})=>({state:n,dispatch:o})=>{const r=m(t,n.schema);return a.wrapInList(r,e)(n,o)}});const Tt=L.create({name:"commands",addCommands:()=>({...Ot})}),Ct=L.create({name:"editable",addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Pt=L.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new e.Plugin({key:new e.PluginKey("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const o=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1},blur:(e,n)=>{t.isFocused=!1;const o=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1}}}})]}}),At=L.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.command((({tr:n})=>{const{selection:o,doc:r}=n,{empty:s,$anchor:i}=o,{pos:a,parent:c}=i,d=i.parent.isTextblock&&a>0?n.doc.resolve(a-1):i,l=d.parent.type.spec.isolating,p=i.pos-i.parentOffset,u=l&&1===d.parent.childCount?p===i.pos:e.Selection.atStart(r).from===a;return!(!s||!c.type.isTextblock||c.textContent.length||!u||u&&"paragraph"===i.parent.type.name)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),n=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()])),o={Enter:()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()},r={...o},s={...o,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Y()||nt()?s:r},addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("clearDocument"),appendTransaction:(t,n,o)=>{if(!(t.some((t=>t.docChanged))&&!n.doc.eq(o.doc)))return;const{empty:r,from:s,to:i}=n.selection,a=e.Selection.atStart(n.doc).from,l=e.Selection.atEnd(n.doc).to;if(r||!(s===a&&i===l))return;if(!(0===o.doc.textBetween(0,o.doc.content.size," "," ").length))return;const p=o.tr,u=c({state:o,transaction:p}),{commands:h}=new d({editor:this.editor,state:u});return h.clearNodes(),p.steps.length?p:void 0}})]}}),Nt=L.create({name:"tabindex",addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});var $t=Object.freeze({__proto__:null,ClipboardTextSerializer:V,Commands:Tt,Editable:Ct,FocusEvents:Pt,Keymap:At,Tabindex:Nt});class jt{get name(){return this.node.type.name}constructor(t,e,n=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=o}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return null!==(t=this.actualDepth)&&void 0!==t?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new jt(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new jt(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new jt(t,this.editor)}get children(){const t=[];return this.node.content.forEach(((e,n)=>{const o=e.isBlock&&!e.isTextblock,r=this.pos+n+1,s=this.resolvedPos.doc.resolve(r);if(!o&&s.depth<=this.depth)return;const i=new jt(s,this.editor,o,o?e:null);o&&(i.actualDepth=this.depth+1),t.push(new jt(s,this.editor,o,o?e:null))})),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let n=null,o=this.parent;for(;o&&!n;){if(o.node.type.name===t)if(Object.keys(e).length>0){const t=o.node.attrs,n=Object.keys(e);for(let o=0;o<n.length;o+=1){const r=n[o];if(t[r]!==e[r])break}}else n=o;o=o.parent}return n}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},n=!1){let o=[];if(!this.children||0===this.children.length)return o;const r=Object.keys(e);return this.children.forEach((s=>{if(!(n&&o.length>0)){if(s.node.type.name===t){r.every((t=>e[t]===s.node.attrs[t]))&&o.push(s)}n&&o.length>0||(o=o.concat(s.querySelectorAll(t,e,n)))}})),o}setAttribute(t){const e=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,t).setTextSelection(e.from).run()}}function It(t,e,n){const o=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==o)return o;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style"+(n?`-${n}`:""),""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}class Rt{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=y(p(this,"addOptions",{name:this.name}))),this.storage=y(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Rt(t)}configure(t={}){const e=this.extend({...this.config,addOptions(){var e;return z((null===(e=this.parent)||void 0===e?void 0:e.call(this))||{},t)}});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new Rt(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=y(p(e,"addOptions",{name:e.name})),e.storage=y(p(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,o=t.state.selection.$from;if(o.pos===o.end()){const r=o.marks();if(!!!r.find((t=>(null==t?void 0:t.type.name)===e.name)))return!1;const s=r.find((t=>(null==t?void 0:t.type.name)===e.name));return s&&n.removeStoredMark(s),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}}class Bt{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=y(p(this,"addOptions",{name:this.name}))),this.storage=y(p(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Bt(t)}configure(t={}){const e=this.extend({...this.config,addOptions(){var e;return z((null===(e=this.parent)||void 0===e?void 0:e.call(this))||{},t)}});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new Bt(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=y(p(e,"addOptions",{name:e.name})),e.storage=y(p(e,"addStorage",{name:e.name,options:e.options})),e}}t.CommandManager=d,t.Editor=class extends l{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t}},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=It('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=v(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],o=this.state.reconfigure({plugins:n});this.view.updateState(o)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[Ct,V.configure({blockSeparator:null===(e=null===(t=this.options.coreExtensionOptions)||void 0===t?void 0:t.clipboardTextSerializer)||void 0===e?void 0:e.blockSeparator}),Tt,Pt,At,Nt]:[],...this.options.extensions].filter((t=>["extension","node","mark"].includes(null==t?void 0:t.type)));this.extensionManager=new B(n,this)}createCommandManager(){this.commandManager=new d({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let t;try{t=it(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error&&["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message)))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{this.options.extensions=this.options.extensions.filter((t=>"collaboration"!==t.name)),this.createExtensionManager()}}),t=it(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const o=X(t,this.options.autofocus);this.view=new n.EditorView(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:e.EditorState.create({doc:t,selection:o||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=t.getMeta("focus"),r=t.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return ft(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,o="string"==typeof t?e:t;return kt(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return pt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return ht(this.state.doc,{blockSeparator:e,textSerializers:{...H(this.schema),...n}})}get isEmpty(){return wt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}$node(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new jt(e,this)}get $doc(){return this.$pos(0)}},t.Extension=L,t.InputRule=C,t.Mark=Rt,t.Node=Bt,t.NodePos=jt,t.NodeView=class{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,o,r,s,i,a,c;const{view:d}=this.editor,l=t.target,p=3===l.nodeType?null===(n=l.parentElement)||void 0===n?void 0:n.closest("[data-drag-handle]"):l.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(l))||!p)return;let u=0,h=0;if(this.dom!==p){const e=this.dom.getBoundingClientRect(),n=p.getBoundingClientRect(),o=null!==(r=t.offsetX)&&void 0!==r?r:null===(s=t.nativeEvent)||void 0===s?void 0:s.offsetX,c=null!==(i=t.offsetY)&&void 0!==i?i:null===(a=t.nativeEvent)||void 0===a?void 0:a.offsetY;u=n.x-e.x+o,h=n.y-e.y+c}null===(c=t.dataTransfer)||void 0===c||c.setDragImage(this.dom,u,h);const m=e.NodeSelection.create(d.state.doc,this.getPos()),f=d.state.tr.setSelection(m);d.dispatch(f)}stopEvent(t){var n;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!(this.dom.contains(o)&&!(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(o))))return!1;const r=t.type.startsWith("drag"),s="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!s&&!r)return!0;const{isEditable:i}=this.editor,{isDragging:a}=this,c=!!this.node.type.spec.draggable,d=e.NodeSelection.isSelectable(this.node),l="copy"===t.type,p="paste"===t.type,u="cut"===t.type,h="mousedown"===t.type;if(!c&&d&&r&&t.preventDefault(),c&&r&&!a)return t.preventDefault(),!1;if(c&&i&&!a&&h){const t=o.closest("[data-drag-handle]");t&&(this.dom===t||this.dom.contains(t))&&(this.isDragging=!0,document.addEventListener("dragend",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("drop",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("mouseup",(()=>{this.isDragging=!1}),{once:!0}))}return!(a||s||l||p||u||h&&d)}ignoreMutation(t){if(!this.dom||!this.contentDOM)return!0;if("function"==typeof this.options.ignoreMutation)return this.options.ignoreMutation({mutation:t});if(this.node.isLeaf||this.node.isAtom)return!0;if("selection"===t.type)return!1;if(this.dom.contains(t.target)&&"childList"===t.type&&(Y()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&this.editor.isFocused){if([...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every((t=>t.isContentEditable)))return!1}return this.contentDOM===t.target&&"attributes"===t.type||!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command((({tr:e})=>{const n=this.getPos();return e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0}))}deleteNode(){const t=this.getPos(),e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}},t.PasteRule=$,t.Tracker=class{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce(((t,n)=>{const o=n.getMap().mapResult(t);return o.deleted&&(e=!0),o.pos}),t),deleted:e}}},t.callOrReturn=y,t.combineTransactionSteps=function(t,e){const n=new s.Transform(t);return e.forEach((t=>{t.steps.forEach((t=>{n.step(t)}))})),n},t.createChainableState=c,t.createDocument=it,t.createNodeFromContent=tt,t.createStyleTag=It,t.defaultBlockAt=ct,t.deleteProps=st,t.elementFromString=Z,t.escapeForRegEx=function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")},t.extensions=$t,t.findChildren=function(t,e){const n=[];return t.descendants(((t,o)=>{e(t)&&n.push({node:t,pos:o})})),n},t.findChildrenInRange=function(t,e,n){const o=[];return t.nodesBetween(e.from,e.to,((t,e)=>{n(t)&&o.push({node:t,pos:e})})),o},t.findDuplicates=R,t.findParentNode=lt,t.findParentNodeClosestToPos=dt,t.fromString=k,t.generateHTML=function(t,e){const n=ut(e);return pt(r.Node.fromJSON(n,t).content,n)},t.generateJSON=function(t,e){const n=ut(e),o=Z(t);return r.DOMParser.fromSchema(n).parse(o).toJSON()},t.generateText=function(t,e,n){const{blockSeparator:o="\n\n",textSerializers:s={}}=n||{},i=ut(e);return ht(r.Node.fromJSON(i,t),{blockSeparator:o,textSerializers:{...H(i),...s}})},t.getAttributes=ft,t.getAttributesFromExtensions=h,t.getChangedRanges=function(t){const{mapping:e,steps:n}=t,o=[];return e.maps.forEach(((t,r)=>{const s=[];if(t.ranges.length)t.forEach(((t,e)=>{s.push({from:t,to:e})}));else{const{from:t,to:e}=n[r];if(void 0===t||void 0===e)return;s.push({from:t,to:e})}s.forEach((({from:t,to:n})=>{const s=e.slice(r).map(t,-1),i=e.slice(r).map(n),a=e.invert().map(s,-1),c=e.invert().map(i);o.push({oldRange:{from:a,to:c},newRange:{from:s,to:i}})}))})),function(t){const e=gt(t);return 1===e.length?e:e.filter(((t,n)=>!e.filter(((t,e)=>e!==n)).some((e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to))))}(o)},t.getDebugJSON=function t(e,n=0){const o=e.type===e.type.schema.topNodeType?0:1,r=n,s=r+e.nodeSize,i=e.marks.map((t=>{const e={type:t.type.name};return Object.keys(t.attrs).length&&(e.attrs={...t.attrs}),e})),a={...e.attrs},c={type:e.type.name,from:r,to:s};return Object.keys(a).length&&(c.attrs=a),i.length&&(c.marks=i),e.content.childCount&&(c.content=[],e.forEach(((e,r)=>{var s;null===(s=c.content)||void 0===s||s.push(t(e,n+r+o))}))),e.text&&(c.text=e.text),c},t.getExtensionField=p,t.getHTMLFromFragment=pt,t.getMarkAttributes=at,t.getMarkRange=_,t.getMarkType=J,t.getMarksBetween=vt,t.getNodeAtPosition=(t,e,n,o=20)=>{const r=t.doc.resolve(n);let s=o,i=null;for(;s>0&&null===i;){const t=r.node(s);(null==t?void 0:t.type.name)===e?i=t:s-=1}return[i,s]},t.getNodeAttributes=mt,t.getNodeType=m,t.getRenderedAttributes=g,t.getSchema=ut,t.getSchemaByResolvedExtensions=M,t.getSchemaTypeByName=S,t.getSchemaTypeNameByName=rt,t.getSplittedAttributes=yt,t.getText=ht,t.getTextBetween=F,t.getTextContentFromNodes=O,t.getTextSerializersFromSchema=H,t.injectExtensionAttributesToParseRule=x,t.inputRulesPlugin=A,t.isActive=kt,t.isAtEndOfNode=(t,e)=>{const{$from:n,$to:o,$anchor:r}=t.selection;if(e){const n=lt((t=>t.type.name===e))(t.selection);if(!n)return!1;const o=t.doc.resolve(n.pos+1);return r.pos+1===o.end()}return!(o.parentOffset<o.parent.nodeSize-2||n.pos!==o.pos)},t.isAtStartOfNode=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)},t.isEmptyObject=b,t.isExtensionRulesEnabled=E,t.isFunction=v,t.isList=xt,t.isMacOS=nt,t.isMarkActive=bt,t.isNodeActive=ot,t.isNodeEmpty=wt,t.isNodeSelection=function(t){return t instanceof e.NodeSelection},t.isNumber=N,t.isPlainObject=D,t.isRegExp=T,t.isString=function(t){return"string"==typeof t},t.isTextSelection=U,t.isiOS=Y,t.markInputRule=function(t){return new C({find:t.find,handler:({state:e,range:n,match:o})=>{const r=y(t.getAttributes,void 0,o);if(!1===r||null===r)return null;const{tr:s}=e,i=o[o.length-1],a=o[0];if(i){const o=a.search(/\S/),c=n.from+a.indexOf(i),d=c+i.length;if(vt(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>c)).length)return null;d<n.to&&s.delete(d,n.to),c>n.from&&s.delete(n.from+o,c);const l=n.from+o+i.length;s.addMark(n.from+o,l,t.type.create(r||{})),s.removeStoredMark(t.type)}}})},t.markPasteRule=function(t){return new $({find:t.find,handler:({state:e,range:n,match:o,pasteEvent:r})=>{const s=y(t.getAttributes,void 0,o,r);if(!1===s||null===s)return null;const{tr:i}=e,a=o[o.length-1],c=o[0];let d=n.to;if(a){const o=c.search(/\S/),r=n.from+c.indexOf(a),l=r+a.length;if(vt(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>r)).length)return null;l<n.to&&i.delete(l,n.to),r>n.from&&i.delete(n.from+o,r),d=n.from+o+a.length,i.addMark(n.from+o,d,t.type.create(s||{})),i.removeStoredMark(t.type)}}})},t.mergeAttributes=f,t.mergeDeep=z,t.minMax=G,t.nodeInputRule=function(t){return new C({find:t.find,handler:({state:e,range:n,match:o})=>{const r=y(t.getAttributes,void 0,o)||{},{tr:s}=e,i=n.from;let a=n.to;const c=t.type.create(r);if(o[1]){let t=i+o[0].lastIndexOf(o[1]);t>a?t=a:a=t+o[1].length;const e=o[0][o[0].length-1];s.insertText(e,i+o[0].length-1),s.replaceWith(t,a,c)}else if(o[0]){const e=t.type.isInline?i:i-1;s.insert(e,t.type.create(r)).delete(s.mapping.map(i),s.mapping.map(a))}s.scrollIntoView()}})},t.nodePasteRule=function(t){return new $({find:t.find,handler({match:e,chain:n,range:o,pasteEvent:r}){const s=y(t.getAttributes,void 0,e,r);if(!1===s||null===s)return null;e.input&&n().deleteRange(o).insertContentAt(o.from,{type:t.type.name,attrs:s})}})},t.objectIncludes=q,t.pasteRulesPlugin=I,t.posToDOMRect=function(t,e,n){const o=t.state.doc.content.size,r=G(e,0,o),s=G(n,0,o),i=t.coordsAtPos(r),a=t.coordsAtPos(s,-1),c=Math.min(i.top,a.top),d=Math.max(i.bottom,a.bottom),l=Math.min(i.left,a.left),p=Math.max(i.right,a.right),u={top:c,bottom:d,left:l,right:p,width:p-l,height:d-c,x:l,y:c};return{...u,toJSON:()=>u}},t.removeDuplicates=gt,t.resolveFocusPosition=X,t.selectionToInsertionEnd=et,t.splitExtensions=u,t.textInputRule=function(t){return new C({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)}})},t.textPasteRule=function(t){return new $({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)}})},t.textblockTypeInputRule=function(t){return new C({find:t.find,handler:({state:e,range:n,match:o})=>{const r=e.doc.resolve(n.from),s=y(t.getAttributes,void 0,o)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})},t.wrappingInputRule=function(t){return new C({find:t.find,handler:({state:e,range:n,match:o,chain:r})=>{const i=y(t.getAttributes,void 0,o)||{},a=e.tr.delete(n.from,n.to),c=a.doc.resolve(n.from).blockRange(),d=c&&s.findWrapping(c,t.type,i);if(!d)return null;if(a.wrap(c,d),t.keepMarks&&t.editor){const{selection:n,storedMarks:o}=e,{splittableMarks:r}=t.editor.extensionManager,s=o||n.$to.parentOffset&&n.$from.marks();if(s){const t=s.filter((t=>r.includes(t.type.name)));a.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";r().updateAttributes(e,i).run()}const l=a.doc.resolve(n.from-1).nodeBefore;l&&l.type===t.type&&s.canJoin(a.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(o,l))&&a.join(n.from-1)}})}}));
//# sourceMappingURL=/sm/3833f4ba1f2cbd6e11e9fbe2e4f7b6e615b49d2c35525e584fea8de2c5f268ee.map