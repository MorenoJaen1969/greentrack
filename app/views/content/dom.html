<!DOCTYPE html>
<html lang="es"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenTrack Live</title>

    <!-- Cargar head.php (contiene enlaces a CSS y JS) -->
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenTrack Live</title>
    
    <link rel="shortcut icon" href="/app/views/img/track.png">

    <!-- Js principal -->
    
    <!-- Estilos del dashboard -->
    <link rel="stylesheet" href="/app/views/inc/css/style.css">

    <!-- Carrusel: Estilos -->
    <link rel="stylesheet" href="/app/views/inc/css/carrusel.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">

</head>
<body>
    <!-- El contenido principal lo define dashboard-view.php -->
    <!-- app/views/content/dashboard-view.php -->
<div class="dashboard-container">
    <!-- 30% - Carrusel de servicios -->
    <div class="carousel-wrapper">
        <div class="elem_row">
            <h3 class="carousel-title">
                Day's Itinirary 
                <span id="fecha-display" style="color: #fffb23ff; margin: 0 8px;">01 sept</span>
                <span id="hora-display" style="color: #4aff1cff;">08:04:57</span>
                <button id="btn-daily-status" class="button" style="margin-left: 10px;">
                    Daily Status
                </button>
                <button id="btn-select-client" class="button" style="margin-left: 10px;">
                    Select Client
                </button>
            </h3>
        </div>

        <!-- Contenedor del carrusel (igual a tu estructura) -->
        <div class="carrusel-container">
        <div class="contenedor-piso-detalles">
            <div class="carrusel" id="servicio-carrusel">
                <div id="carrusel" class="dis_caja forma_caja" style="display: flex;">
        <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; text-align: center; color: #666; font-family: Arial, sans-serif; padding: 20px; width: 100%;">
            <h3>Waiting for today's services...</h3>
            <p>System will start automatically when services are loaded.</p>
            <div id="contador-polling" style="font-size: 0.9em; margin-top: 10px;">Attempts: 3</div>
        </div></div>
            <!-- Tarjetas generadas por JS -->
            </div>
        </div>
        </div>
    </div>

    <!-- 70% - Mapa -->
    <div class="map-wrapper">
        <div id="live-map" class="leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" style="position: relative; outline-style: none;" tabindex="0"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="https://a.tile.openstreetmap.org/12/961/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, 391px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/961/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, 647px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/960/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, 391px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/962/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, 391px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/960/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, 647px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/962/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, 647px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/961/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, 135px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/961/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, 903px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/960/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, 135px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/962/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, 135px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/960/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, 903px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/962/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, 903px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/959/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, 391px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/963/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, 391px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/959/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, 647px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/963/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, 647px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/961/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, -121px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/959/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, 135px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/963/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, 135px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/959/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, 903px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/963/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, 903px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/961/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(559px, 1159px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/960/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, -121px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/962/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, -121px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/960/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(303px, 1159px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/962/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(815px, 1159px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/958/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, 391px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/964/1685.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, 391px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/958/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, 647px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/964/1686.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, 647px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/959/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, -121px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/963/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, -121px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/959/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(47px, 1159px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/963/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1071px, 1159px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/958/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, 135px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/964/1684.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, 135px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/958/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, 903px, 0px); opacity: 1;"><img alt="" src="https://c.tile.openstreetmap.org/12/964/1687.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, 903px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/958/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, -121px, 0px); opacity: 1;"><img alt="" src="https://b.tile.openstreetmap.org/12/964/1683.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, -121px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/958/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-209px, 1159px, 0px); opacity: 1;"><img alt="" src="https://a.tile.openstreetmap.org/12/964/1688.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1327px, 1159px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(246197px, 431574px, 0px) scale(2048);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">−</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div></div></div></div>
    </div>
</div>

<!-- Modal: Daily Status Matrix -->
<div id="modal-daily-status" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10000; justify-content: center; align-items: center;">
    <div style="background: white; width: 90%; max-width: 1400px; height: 85vh; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
        <!-- Encabezado -->
        <div style="padding: 15px; background: #2196F3; color: white; display: flex; justify-content: space-between; align-items: center;">
            <h3 style="margin: 0; font-size: 1.2em;">Daily Status – Crew vs Clients</h3>
            <button id="close-daily-status" style="background: #f44336; color: white; border: none; width: 32px; height: 32px; border-radius: 50%; font-size: 18px; cursor: pointer;">✕</button>
        </div>
        <!-- Contenido -->
        <div id="matrix-container" style="flex: 1; overflow: auto; padding: 10px;">
            <table id="daily-status-matrix" class="tabla-matriz" style="width: 100%; border-collapse: collapse; font-size: 0.8em;">
                <thead>
                    <tr style="background: #f0f0f0;">
                        <th style="border: 1px solid #ddd; padding: 8px; position: sticky; top: 0; left: 0; background: #e0e0e0; z-index: 3;">Client</th>
                        <!-- Crews se insertarán aquí -->
                    </tr>
                </thead>
                <tbody id="matrix-body">
                    <!-- Filas de clientes -->
                </tbody>
                <tfoot id="matrix-footer">
                    <!-- Fila de totales -->
                </tfoot>
            </table>
        </div>
    </div>
</div>    

<div id="modal-select-client" class="segundo_proceso" style="display: none;">
    <div class="modal-contenedor" style="width: 50%;">
        <div class="modal-header">
            <button id="close-select-client" class="modal-cerrar">×</button>
            <h3 class="titulo_modal">Select Client</h3>
        </div>
        <div id="lista-clientes" style="max-height: 50vh; overflow-y: auto;">
            <p>Loading...</p>
        </div>
    </div>
</div>


<script>
// Actualizar fecha y hora en tiempo real
function actualizarReloj() {
    const ahora = new Date();
    
    // Formato: 15 Abr
    const opcionesFecha = { day: '2-digit', month: 'short' };
    const fecha = ahora.toLocaleDateString('es-ES', opcionesFecha)
                    .replace('.', ''); // Quitar el punto de "abr."

    // Formato: hh:mm:ss
    const hora = ahora.toLocaleTimeString('es-ES', { 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit',
        hour12: false 
    });

    // Actualizar el DOM
    document.getElementById('fecha-display').textContent = fecha;
    document.getElementById('hora-display').textContent = hora;
}

// Actualizar cada segundo
actualizarReloj();
setInterval(actualizarReloj, 1000);
</script>    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Carrusel: JS (solo animación) -->
    <script src="/app/views/inc/js/script.js"></script>

</body></html>